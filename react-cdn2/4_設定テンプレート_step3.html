<!DOCTYPE html>
<html lang="ja">
<!--
テンプレートだけですべての設定入力フォームを作るサンプル
　React + React Router + MUI + React Hook Form (yupなし)
  複数ページ対応（読み込みは全ページ。設定はページごとに実施）
-->
<head>
  <title>ReactCDN</title>
  <meta charset="utf-8">
  <meta name="viewport" content="initail-scale=1, width=device-width">
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@mui/material@latest/umd/material-ui.development.js" crossorigin="anonymous"></script>
  <script src='https://unpkg.com/react-router-dom@5/umd/react-router-dom.min.js'></script>
  <script src="https://cdn.jsdelivr.net/npm/react-hook-form@7/dist/index.umd.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
  <div id="app"></div>
  <script type="text/babel">

    const template = {
      title: 'ConfigTemplate',
      // 左メニュー
      menu: [
        {
          id: 'State',
          children: [
            { id: 'state', name: '現在の状態', icon: 'home', to: '/state' },
          ],
        },
        {
          id: 'Config',
          children: [
            { id: 'General', name: '一般設定', icon: 'dashboard', to: '/general' },
            { id: 'Wifi', name: 'Wi-Fi基本設定', icon: 'wifi', to: '/wifi24g' },
          ],
        },
        {
          id: 'Develop',
          children: [
            { id: 'Misc', name: 'その他', icon: 'settings', to: '/misc' },
          ],
        },
      ],

      // ページ定義
      //  sample: {
      //    type: 'text', // 入力形式
      //    key: 'hostname', // jsonの該当する値（階層構造にはできません）
      //    name: '装置名', // 項目名
      //    default: '', // デフォルト値（現在動作させていない）
      //    rules: 'required', // バリデーションルール
      //    show: {}, // 表示条件を付けたい場合はshow
      //    items: {} // selectの場合はitems
      //  },
      pages: {
        state: {
          title: '現在の設定',
          subheader: '設定できないページ',
          readonly: true,
          sections: [
            {
              section_name: '基本設定',
              items: [
                {
                  type: 'text',
                  key: 'general.hostname',
                  name: '装置名',
                  default: '',
                  rules: 'required|min:2'
                },
              ]
            }
          ]
        },
        general: {
          title: '一般設定',
          subheader: 'テンプレートだけでページ生成',
          sections: [
            {
              section_name: '基本設定',
              items: [
                {
                  type: 'text',
                  key: 'general.hostname',
                  name: '装置名',
                  default: '',
                  rules: 'required|min:2'
                },
                {
                  type: 'switch',
                  key: 'general.dhcp',
                  name: 'DHCPクライアント機能',
                  default: true,
                  rules: 'required'
                },
                {
                  type: 'switch',
                  key: 'general.globalip',
                  show: { key: 'general.dhcp', value: false }, // dhcpがfalseなら項目表示
                  name: 'グローバルIPアドレス',
                  default: false,
                  rules: 'required'
                },
                {
                  type: 'text',
                  key: 'general.ip',
                  show: { key: 'general.dhcp', value: false },
                  name: 'IPアドレス',
                  default: true,
                  rules: 'required|ippfx'
                },
                {
                  type: 'text',
                  key: 'general.gateway',
                  show: { key: 'general.dhcp', value: false },
                  name: 'ゲートウェイアドレス',
                  default: true,
                  rules: 'required|ip'
                },
                {
                  type: 'text',
                  key: 'general.dns1',
                  show: { key: 'general.dhcp', value: false },
                  name: 'プライマリDNS',
                  default: '',
                  rules: 'ip'
                },
                {
                  type: 'text',
                  key: 'general.dns2',
                  show: { key: 'general.dhcp', value: false },
                  name: 'セカンダリDNS',
                  default: '',
                  rules: 'ip'
                },

              ]
            },
            {
              section_name: 'インタフェース設定',
              items: [
                {
                  type: 'select',
                  key: 'general.wanEth',
                  name: 'WAN側Ethernet設定',
                  default: 'auto',
                  rules: 'required',
                  items: [
                    { text: '---', value: '' },
                    { text: '自動設定', value: 'auto' },
                    { text: '100Mbps/全二重', value: '100/full' },
                    { text: '100Mbps/半二重', value: '100/half' },
                    { text: '10Mbps/全二重', value: '10/full' },
                    { text: '10Mbps/半二重', value: '10/half' }
                  ]
                },
                {
                  type: 'switch',
                  key: 'general.lanJambo',
                  name: 'LAN側ジャンボフレーム透過機能',
                  default: false,
                  rules: 'required'
                },
                {
                  type: 'switch',
                  key: 'general.lanPause',
                  name: 'LAN側Pause機能',
                  default: true,
                  rules: 'required'
                },
              ]
            },
            {
              section_name: 'その他の設定',
              items: [
                {
                  type: 'switch',
                  key: 'general.media',
                  name: 'メディアサーバ設定',
                  default: true,
                  rules: 'required'
                },
                {
                  type: 'switch',
                  key: 'general.verup',
                  name: 'メンテナンスバージョンアップ機能',
                  default: true,
                  rules: 'required'
                },
                {
                  type: 'switch',
                  key: 'general.homeIPLocation',
                  name: 'ホームIPロケーション機能',
                  default: false,
                  rules: 'required'
                },
                {
                  type: 'switch',
                  key: 'general.srcValidate',
                  name: '送信元検証機能',
                  default: true,
                  rules: 'required'
                },
              ]
            }
          ]
        },
        wifi24g: {
          title: 'Wi-Fi詳細設定(2.4GHz)',
          subheader: 'テンプレートだけでページ生成２',
          sections: [
            {
              section_name: 'Wi-Fi機能設定',
              items: [
                {
                  type: 'switch',
                  key: 'wifi24g.wifi',
                  name: 'Wi-Fi機能',
                  default: true
                },
                {
                  type: 'text',
                  key: 'wifi24g.ssid',
                  name: 'ネットワーク名(SSID)',
                  default: '',
                  rules: 'required|alpha_dash|max:32'
                },
                {
                  type: 'switch',
                  key: 'wifi24g.auto',
                  name: 'オートチャネルセレクト機能',
                  default: true
                },
                {
                  type: 'select',
                  key: 'wifi24g.dual',
                  name: 'デュアルチャネル機能',
                  default: 'auto',
                  rules: 'required',
                  items: [
                    { text: '---', value: '' },
                    { text: '使用する(自動切替)', value: 'auto' },
                    { text: '使用する(優先)', value: 'pri' },
                    { text: '使用しない', value: 'disable' }
                  ]
                },
                {
                  type: 'select',
                  key: 'wifi24g.channel',
                  name: '使用チャネル',
                  default: '1',
                  items: [
                    { text: '---', value: '' },
                    { text: '1', value: '1' }
                  ]
                },
                {
                  type: 'switch',
                  key: 'wifi24g.isolate',
                  name: 'ネットワーク分離機能',
                  default: false
                },
                {
                  type: 'switch',
                  key: 'wifi24g.separate',
                  name: 'SSID内分離(セパレータ)',
                  default: false
                }
              ]
            },
            {
              section_name: '暗号化',
              items: [
                {
                  type: 'select',
                  key: 'wifi24g.mode',
                  name: '暗号化モード',
                  default: 'WPA/WPA2-PSK(AES)',
                  items: [
                    { text: '暗号化無効', value: 'disable' },
                    { text: 'WPA2-PSK(AES)', value: 'WPA2-PSK(AES)' },
                    { text: 'WPA/WPA2-PSK(AES)', value: 'WPA/WPA2-PSK(AES)' },
                    { text: 'WPA/WPA2-PSK(TKIP/AES)', value: 'WPA/WPA2-PSK(TKIP/AES)' }
                  ]
                },
                {
                  type: 'text',
                  key: 'wifi24g.psk',
                  name: 'WPA暗号化キー(PSK)',
                  default: '',
                  rules: 'required|alpha_dash|max:32'
                },
                {
                  type: 'number',
                  key: 'wifi24g.interval',
                  name: '暗号化キー更新間隔(分)',
                  default: '30',
                  rules: 'required|min_value:0|max_value:1440'
                }
              ]
            },
            {
              section_name: '子機の接続制限',
              items: [
                {
                  type: 'switch',
                  key: 'wifi24g.stealth',
                  name: 'ESS-IDステルス機能(SSIDの隠蔽)',
                  default: ''
                },
                {
                  type: 'switch',
                  key: 'wifi24g.filter',
                  name: 'MACアドレスフィルタリング機能',
                  default: ''
                }
              ]
            }
          ]
        },
        misc: {
          title: 'その他',
          subheader: 'サンプル',
          sections: [
            {
              section_name: 'Sample',
              items: [
                {
                  type: 'text',
                  key: 'misc.name',
                  name: '名前',
                  default: '',
                  rules: "required|min:2"
                },
                {
                  type: 'number',
                  key: 'misc.number',
                  name: '数字',
                  default: '',
                  rules: "required|min_value:0,max_value:32"
                },
                {
                  type: 'radio',
                  key: 'misc.radio',
                  name: '選択',
                  default: 'a',
                  items: [
                    { text: 'Aの選択肢', value: 'a' },
                    { text: 'Bの選択肢', value: 'b' },
                    { text: 'Cの選択肢', value: 'c' }
                  ]
                },
                {
                  type: 'select',
                  key: 'misc.select',
                  name: 'セレクト',
                  default: null,
                  rules: "required",
                  items: [
                    { text: '--- 選択してください ---', value: '' },
                    { text: 'Aの選択肢', value: 'a' },
                    { text: 'Bの選択肢', value: 'b' },
                    { text: 'Cの選択肢', value: 'c' }
                  ]
                },
                {
                  type: 'checkbox',
                  key: 'misc.checkbox',
                  name: 'チェックボックス',
                  default: null,
                  items: [
                    { text: 'Aの選択肢', value: 'a' },
                    { text: 'Bの選択肢', value: 'b' },
                    { text: 'Cの選択肢', value: 'c' }
                  ]
                }
              ]
            }
          ]
        }
      },
    }

    // 装置から読み込む現在の状態とコンフィグ
    const host = {
      state: {
        host: {
          hostname: 'ATERM-123456',
          version: '1.0.15',
          mac: '00:11:22:33:44:55'
        },
        wifi24g: {
          name: 'aterm-123456-g',
          mode: '2.4GHz',
          channel: '6',
          ssid: 'ateam-123456-g',
          mac: '00:11:22:33:55:aa',
          isolation: '未使用'
        },
        wifi5g: {
          name: 'aterm-123456-a',
          mode: '5GHz',
          channel: '36&40&44&48',
          ssid: 'ateam-123456-a',
          mac: '00:11:22:33:55:bb',
          isolation: '未使用'
        },
        state: {
          mode: 'ブリッジモード',
          ip: '192.168.1.9/24',
          gateway: '192.168.1.1',
          dns1: '192.168.1.1',
          dns2: '未使用'
        },
        internetAccess: {
          usb_storage: 'アクセス不可',
          usb_camera: 'アクセス不可',
          remoteBoot: 'アクセス不可',
          ddnsUpdate: '未使用'
        },
        homeIPLocation: {
          name: '未使用'
        }
      },
      config: {
        general: {
          hostname: 'ATERM-123456',
          dhcp: true,
          globalip: false,
          ip: '192.168.0.1/24',
          gateway: '192.168.0.254',
          dns1: '',
          dns2: '',
          wanEth: 'auto',
          lanJambo: false,
          lanPause: true,
          media: true,
          verup: true,
          homeIPLocation: false,
          srcValidate: true
        },
        wifi24g: {
          wifi: true,
          ssid: 'aterm-123456-g',
          auto: true,
          dual: 'auto',
          channel: '1',
          isolate: false,
          separate: false,
          mode: 'WPA/WPA2-PSK(AES)',
          psk: '001234456789abcdef',
          interval: '30',
          stealth: true,
          filter: true
        },
        misc: {
          name: 'aaa',
          number: '1',
          radio: 'b',
          select: 'b',
          checkbox: ['a', 'b'],
          email: 'user1@misc.com',
          ip: '192.168.10.1/24',
          switch: true
        },
        card: [
          // cat: 1: adult, 0: child
          { mac: '00:11:22:33:44:55', cat: 1, reg: 1, res: 4, desc: 'SO-04J' },
          { mac: '00:11:22:33:44:66', cat: 0, reg: 1, res: 3, desc: 'SO-04J' },
          { mac: '00:11:22:33:44:77', cat: 1, reg: 0, res: 2, desc: '端末1' },
          { mac: '00:11:22:33:44:88', cat: 1, reg: 0, res: 2, desc: '端末2' },
          { mac: '00:11:22:33:44:99', cat: 1, reg: 0, res: 2, desc: '端末3' },
          { mac: '00:11:22:33:44:aa', cat: 1, reg: 0, res: 1, desc: '端末4' },
          { mac: '00:11:22:33:44:bb', cat: 1, reg: 0, res: 0, desc: '端末5' }
        ]
      }
    }

    function Login() {
      return (
        <>
          <h1>Login</h1>
          <p>テンプレートだけですべての設定入力フォームを作るサンプル</p>
          <p>React + React Router + MUI + React Hook Form (yupなし)</p>
          <p>複数ページ対応（読み込みは全ページ。設定はページごとに実施）</p>
        </>
      )
    }

    function NTextField(props) {
      const { Controller } = ReactHookForm
      const { TextField } = MaterialUI
      const { item, control } = props

      const getRules = (item) => {
        const rules = {}
        if (item.rules?.match(/required/)) {
          rules.required = '入力してください。'
        }
        const min = item.rules?.match(/min:([0-9]+)/)
        if (min) rules.minLength = { value: min[1], message: min[1] + '文字以上で入力してください。' }
        const max = item.rules?.match(/max:([0-9]+)/)
        if (max) rules.maxLength = { value: max[1], message: max[1] + '文字以下で入力してください。' }
        const min_value = item.rules?.match(/min_value:([0-9]+)/)
        if (min_value) rules.min = { value: min_value[1], message: min_value[1] + '以上で入力してください。' }
        const max_value = item.rules?.match(/max_value:([0-9]+)/)
        if (max_value) rules.max = { value: max_value[1], message: max_value[1] + '以下で入力してください。' }

        const ip = item.rules?.match(/ip[^p]*/)
        if (ip) rules.pattern = {
          value: /^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])$/,
          message: 'IPv4アドレスを入力してください'
        }
        const ippfx = item.rules?.match(/ippfx/)
        if (ippfx) rules.pattern = {
          value: /^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\/(3[0-2]|[1-2][0-9]|[0-9])$/,
          message: 'IPv4/プレフィックス長 を入力してください'
        }
        return rules
      }

      return (
        <Controller name={item.key} control={control} rules={getRules(item)} render={({ field, fieldState }) => (
          <TextField fullWidth
            type={item.type}
            size="small"
            label={item.name}
            error={fieldState.invalid}
            helperText={fieldState.error?.message}
            {...field}
          />
        )} />
      )
    }

    function NSwitch(props) {
      const { Controller } = ReactHookForm
      const { Switch } = MaterialUI
      const { item, control } = props

      return (
        <Controller name={item.key} control={control} render={({ field }) => (
          <Switch
            // size="small"
            onChange={(e) => field.onChange(e.target.checked)}
            checked={field.value}
          />
        )} />
      )
    }

    /* 説明のラベル付き */
    function NSwitch2(props) {
      const { Controller } = ReactHookForm
      const { Switch, FormControl, FormLabel, FormGroup, FormControlLabel } = MaterialUI
      const { item, control } = props

      return (
        <Controller name={item.key} control={control} render={({ field }) => (
          <FormControl component="fieldset">
            <FormLabel component="legend">{item.name}</FormLabel>
            <FormGroup>
              <FormControlLabel
                key={item.value}
                control={
                  <Switch
                    // size="small"
                    onChange={(e) => field.onChange(e.target.checked)}
                    checked={field.value}
                    name="ON"
                  />
                } />
            </FormGroup>
          </FormControl>
        )} />
      )
    }

    function NSelect(props) {
      const { Controller } = ReactHookForm
      const { Select, FormControl, MenuItem, InputLabel, FormHelperText } = MaterialUI
      const { item, control } = props

      const getRules = (item) => {
        const rules = {}
        if (item.rules?.match(/required/)) {
          rules.required = '入力してください。'
        }
        return rules
      }

      return (
        <Controller name={item.key} control={control} rules={getRules(item)} render={({ field, fieldState }) => (
          <FormControl fullWidth>
            <InputLabel id={item.key}>{item.name}</InputLabel>
            <Select labelId={item.key} id={item.key} label={item.name} size="small" fullWidth
              error={fieldState.invalid}
              {...field} >
              {item.items.map((item2, i) => (
                <MenuItem key={i} value={item2.value}>{item2.text}</MenuItem>
              ))}
            </Select>
            {fieldState.error && <FormHelperText error>{fieldState.error?.message}</FormHelperText>}
          </FormControl>
        )} />
      )
    }

    function NRadio(props) {
      const { Controller } = ReactHookForm
      const { RadioGroup, Radio, FormControl, FormLabel, FormControlLabel } = MaterialUI
      const { item, control } = props

      return (
        <Controller name={item.key} control={control} render={({ field }) => (
          <FormControl fullWidth>
            {/*<FormLabel id={item.key}>{item.name}</FormLabel>*/}
            <RadioGroup row aria-labelledby={item.key} name={item.name} {...field}>
              {item.items.map((i) => (
                <FormControlLabel
                  key={i.value}
                  control={
                    <Radio />
                  }
                  value={i.value} label={i.text}
                />
              ))}
            </RadioGroup>
          </FormControl>
        )} />
      )
    }
    // https://stackoverflow.com/questions/68163459/react-hook-form-material-ui-checkbox-array

    function NCheckboxes(props) {
      const { useState, useLayoutEffect } = React
      const { Controller, useController } = ReactHookForm
      const { item, control } = props
      const { field } = useController(props)
      const { Checkbox, FormGroup, FormControl, FormLabel, FormControlLabel, MenuItem, InputLabel } = MaterialUI
      const defval = control._defaultValues[item.key] // FIXME: いい取り方わからん。リセットきかない。
      const [update, setUpdata] = useState(false)

      // FIXME: これもデータは初期値に戻るが、画面が戻らない
      useLayoutEffect(() => {
        field.onChange(control._defaultValues[item.key])
        setUpdata(update ? false : true)
      }, [control])

      const handleChange = (e, value, values) => {
        // チェックされたらその値を足して、チェックが外されたらその値を抜く（設定した順に並ぶ）
        e.target.checked ? values.push(value) : values.splice(values.indexOf(value), 1)
        return values
      }

      return (
        <Controller name={item.key} control={control} render={({ field }) => (
          <FormControl fullWidth>
            <FormGroup row>
              {item.items.map((i) => (
                <FormControlLabel
                  key={i.value}
                  control={
                    <Checkbox
                      value={i.value}
                      defaultChecked={defval.includes(i.value)}
                      onChange={(e) => field.onChange(handleChange(e, i.value, field.value))}
                    />
                  }
                  label={i.text}
                />
              ))}
            </FormGroup>
          </FormControl>
        )} />
      )
    }

    function ConfigPage() {
      const { useState, useLayoutEffect, Fragment } = React
      const { useParams } = ReactRouterDOM
      const { useForm, Controller, useWatch } = ReactHookForm
      const { Grid, Stack, Card, CardHeader, CardContent, CardActions, Button, Typography } = MaterialUI
      const { FormControl, Checkbox } = MaterialUI

      const params = useParams()
      const page = params?.page
      const [t, SetTemplate] = useState(template.pages[page])
      const [c, SetConfig] = useState(host.config)

      const defaultValues = {}
      for (const page of Object.keys(c)) {
        for (const item of Object.keys(c[page])) {
          // console.log(`${page}.${item} = ${host.config[page][item]}`)
          defaultValues[`${page}.${item}`] = c[page][item]
        }
      }
      const { control, watch, handleSubmit, reset } = useForm({ defaultValues })
      const onSubmit = data => alert(JSON.stringify(data[page], null, 2))

      useLayoutEffect(() => {
        SetTemplate(template.pages[page])
        reset()
      }, [page])

      return (
        <Card>
          <CardHeader title={t.title} subheader={t.subheader}
            titleTypographyProps={{ variant: "h4", fontWeight: "bold" }} />
          <form onSubmit={handleSubmit(onSubmit)}>
            <CardContent>
              {t.sections.map((section) => (
                <Fragment key={section.section_name}>
                  <Typography variant="h5" sx={{ fontWeight: 'bold', py: 5 }}>{section.section_name}</Typography>
                  <Stack spacing={2}>
                    {section.items.map((item, i) => (
                      <Fragment key={i}>
                        {/* text　でも show.key で記載されている項目が、show.value でなかったら表示しない */}
                        {(item.type === 'text' || item.type === 'number') &&
                          ((item.show && watch(item.show.key) == item.show.value) || !item.show) &&
                          <Grid container>
                            <Grid item xs={4}><Typography variant="body1">{item.name}</Typography></Grid>
                            <Grid item xs={8}><NTextField item={item} control={control} /></Grid>
                          </Grid>
                        }
                        {item.type === 'switch' &&
                          ((item.show && watch(item.show.key) == item.show.value) || !item.show) &&
                          <Grid container>
                            <Grid item xs={4}><Typography variant="body1">{item.name}</Typography></Grid>
                            <Grid item xs={8}><NSwitch item={item} control={control} /></Grid>
                          </Grid>
                        }
                        {item.type === 'select' &&
                          ((item.show && watch(item.show.key) == item.show.value) || !item.show) &&
                          <Grid container>
                            <Grid item xs={4}><Typography variant="body1">{item.name}</Typography></Grid>
                            <Grid item xs={8}><NSelect item={item} control={control} /></Grid>
                          </Grid>
                        }
                        {item.type === 'radio' &&
                          ((item.show && watch(item.show.key) == item.show.value) || !item.show) &&
                          <Grid container>
                            <Grid item xs={4}><Typography variant="body1">{item.name}</Typography></Grid>
                            <Grid item xs={8}><NRadio item={item} control={control} /></Grid>
                          </Grid>
                        }
                        {item.type === 'checkbox' &&
                          ((item.show && watch(item.show.key) == item.show.value) || !item.show) &&
                          <Grid container>
                            <Grid item xs={4}><Typography variant="body1">{item.name}</Typography></Grid>
                            <Grid item xs={8}><NCheckboxes name="a" item={item} control={control} /></Grid>
                          </Grid>
                        }
                      </Fragment>
                    ))}
                  </Stack>
                </Fragment>
              ))}
            </CardContent>
            <CardActions>
              {!t.readonly &&
                <>
                  <Button variant="contained" type="submit">
                    設定
                  </Button>
                  <Button variant="contained" color="inherit" onClick={() => reset(defaultValues)} >
                    キャンセル
                  </Button>
                </>
              }
            </CardActions>
          </form>
        </Card>
      )
    }

    function Layout({ children }) {
      const { Link } = ReactRouterDOM
      const { Container, AppBar, Toolbar, Divider, Box, Drawer, Card, List, ListItem, ListItemIcon, ListItemButton, ListItemText, Typography, Icon } = MaterialUI

      const drawerWidth = 240

      return (
        <Box sx={{ display: 'flex' }}>
          <Drawer variant="permanent" sx={{
            width: drawerWidth, flexShrink: 0,
            [`& .MuiDrawer-paper`]: { width: drawerWidth, boxSizing: 'border-box' }
          }}
          >
            <Box sx={{ overflow: 'auto' }}>
              <List disablePadding>
                <ListItem sx={{ fontSize: 22, px: 3, py: 1 }}>
                  {template.title}
                </ListItem>
                < Divider />
                {template.menu.map(({ id, children }) => (
                  <Box key={id}>
                    <ListItem sx={{ py: 1, px: 3 }}>
                      <ListItemText >{id}</ListItemText>
                    </ListItem>
                    {
                      children.map(({ id: childId, name, icon, to, active }) => (
                        <ListItem disablePadding key={childId}>
                          <ListItemButton component={Link} to={to} selected={active}>
                            <ListItemIcon><Icon>{icon}</Icon></ListItemIcon>
                            <ListItemText>{name}</ListItemText>
                          </ListItemButton>
                        </ListItem>
                      ))
                    }
                    < Divider sx={{ mt: 2 }} />
                  </Box>
                ))}
              </List>
            </Box>
          </Drawer>
          <Container>
            <Box component="main" sx={{ flexGrow: 1, p: 3 }}>
              {children}
            </Box>
          </Container>
        </Box>
      )
    }
    const App = () => {
      const { useState } = React
      const { HashRouter, useRouteMatch, Switch, Link, Route } = ReactRouterDOM
      const { createTheme, ThemeProvider, CssBaseline } = MaterialUI

      const [t, SetTemplate] = useState(template)

      const theme = createTheme({
        palette: {
          primary: { light: '#63ccff', main: '#009be5', dark: '#006db3' },
          background: { default: '#f5f5f5' },
        }
      })

      return (
        <ThemeProvider theme={theme}>
          <CssBaseline />
          <HashRouter>
            <Switch>
              <Route path='/:path?' exact>
                <Layout>
                  {t &&
                    <Route path='/' render={({ match: { url } }) => (
                      <Switch>
                        <Route path="/" exact component={Login} />
                        <Route path="/:page" exact component={ConfigPage} />
                      </Switch>
                    )} />
                  }
                </Layout>
              </Route>
            </Switch>
          </HashRouter>
        </ThemeProvider>
      )
    }
    const container = document.getElementById('app')
    const root = ReactDOM.createRoot(container)
    root.render(<App />)
  </script>
</body>
</html>
